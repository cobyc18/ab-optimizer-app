{% comment %}
  Product Badge Widget
  Displays customizable badges on product pages with desktop and mobile settings
{% endcomment %}

<style>
  .ab-optimizer-badge {
    display: inline-block;
    box-sizing: border-box;
  }
  
  /* Desktop styles */
  @media (min-width: 768px) {
    .ab-optimizer-badge {
      font-family: {{ block.settings.desktop_font_family }};
      font-size: {{ block.settings.desktop_font_size }}px;
      line-height: {{ block.settings.desktop_line_height }};
      text-align: {{ block.settings.desktop_content_alignment }};
      width: {{ block.settings.desktop_width }}%;
      padding: {{ block.settings.desktop_padding_vertical }}px {{ block.settings.desktop_padding_horizontal }}px;
      margin: {{ block.settings.desktop_margin }}px;
      gap: {{ block.settings.desktop_gap }}px;
      border-radius: {{ block.settings.desktop_roundness }}px;
      border: {{ block.settings.desktop_border_thickness }}px solid {{ block.settings.border_color }};
      box-shadow: {{ block.settings.desktop_shadow_style }};
    }
  }
  
  /* Mobile styles */
  @media (max-width: 767px) {
    .ab-optimizer-badge {
      font-family: {{ block.settings.mobile_font_family }};
      font-size: {{ block.settings.mobile_font_size }}px;
      line-height: {{ block.settings.mobile_line_height }};
      text-align: {{ block.settings.mobile_content_alignment }};
      width: {{ block.settings.mobile_width }}%;
      padding: {{ block.settings.mobile_padding_vertical }}px {{ block.settings.mobile_padding_horizontal }}px;
      margin: {{ block.settings.mobile_margin }}px;
      gap: {{ block.settings.mobile_gap }}px;
      border-radius: {{ block.settings.mobile_roundness }}px;
      border: {{ block.settings.mobile_border_thickness }}px solid {{ block.settings.border_color }};
      box-shadow: {{ block.settings.mobile_shadow_style }};
    }
  }
</style>

<div class="ab-optimizer-badge" 
     style="
       background: {{ block.settings.background_color }};
       color: {{ block.settings.text_color }};
       font-weight: bold;
     ">
  
  {% case block.settings.badge_type %}
    {% when 'custom' %}
      {{ block.settings.custom_text }}
    {% when 'sale' %}
      {% if product.compare_at_price > product.price %}
        SALE
      {% endif %}
    {% when 'new' %}
      {% assign product_age = 'now' | date: '%s' | minus: product.created_at | date: '%s' | divided_by: 86400 %}
      {% if product_age <= 30 %}
        NEW
      {% endif %}
    {% when 'limited' %}
      {% if product.available and product.inventory_quantity <= 10 %}
        LIMITED
      {% endif %}
  {% endcase %}
</div>

{% schema %}
{
  "name": "Product Badge",
  "target": "section",
  "settings": [
    {
      "type": "select",
      "id": "badge_type",
      "label": "Badge Type",
      "options": [
        { "value": "custom", "label": "Custom Text" },
        { "value": "sale", "label": "Sale Badge" },
        { "value": "new", "label": "New Product" },
        { "value": "limited", "label": "Limited Stock" }
      ],
      "default": "custom"
    },
    {
      "type": "text",
      "id": "custom_text",
      "label": "Custom Badge Text",
      "default": "SPECIAL"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#32cd32"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "#228b22"
    },
    {
      "type": "header",
      "content": "Desktop Settings"
    },
    {
      "type": "select",
      "id": "desktop_alignment",
      "label": "Desktop Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "desktop_font_family",
      "label": "Desktop Font Family",
      "options": [
        { "value": "Arial, sans-serif", "label": "Arial" },
        { "value": "Helvetica, sans-serif", "label": "Helvetica" },
        { "value": "Georgia, serif", "label": "Georgia" },
        { "value": "Times New Roman, serif", "label": "Times New Roman" },
        { "value": "Verdana, sans-serif", "label": "Verdana" },
        { "value": "Courier New, monospace", "label": "Courier New" }
      ],
      "default": "Arial, sans-serif"
    },
    {
      "type": "range",
      "id": "desktop_font_size",
      "label": "Desktop Font Size",
      "min": 10,
      "max": 32,
      "step": 1,
      "default": 14
    },
    {
      "type": "range",
      "id": "desktop_line_height",
      "label": "Desktop Line Height",
      "min": 1.0,
      "max": 2.0,
      "step": 0.1,
      "default": 1.2
    },
    {
      "type": "range",
      "id": "desktop_margin",
      "label": "Desktop Margin",
      "min": 0,
      "max": 40,
      "step": 1,
      "default": 8
    },
    {
      "type": "range",
      "id": "desktop_gap",
      "label": "Desktop Gap",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 4
    },
    {
      "type": "range",
      "id": "desktop_width",
      "label": "Desktop Width (%)",
      "min": 10,
      "max": 100,
      "step": 5,
      "default": 100
    },
    {
      "type": "range",
      "id": "desktop_padding_vertical",
      "label": "Desktop Padding Vertical",
      "min": 4,
      "max": 32,
      "step": 1,
      "default": 8
    },
    {
      "type": "range",
      "id": "desktop_padding_horizontal",
      "label": "Desktop Padding Horizontal",
      "min": 8,
      "max": 40,
      "step": 1,
      "default": 16
    },
    {
      "type": "range",
      "id": "desktop_border_thickness",
      "label": "Desktop Border Thickness",
      "min": 0,
      "max": 8,
      "step": 1,
      "default": 1
    },
    {
      "type": "range",
      "id": "desktop_roundness",
      "label": "Desktop Roundness",
      "min": 0,
      "max": 30,
      "step": 1,
      "default": 6
    },
    {
      "type": "select",
      "id": "desktop_shadow_style",
      "label": "Desktop Shadow Style",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "0 1px 3px rgba(0,0,0,0.12)", "label": "Subtle" },
        { "value": "0 2px 8px rgba(0,0,0,0.15)", "label": "Medium" },
        { "value": "0 4px 12px rgba(0,0,0,0.2)", "label": "Strong" },
        { "value": "0 8px 25px rgba(0,0,0,0.25)", "label": "Heavy" }
      ],
      "default": "0 1px 3px rgba(0,0,0,0.12)"
    },
    {
      "type": "select",
      "id": "desktop_content_alignment",
      "label": "Desktop Content Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "select",
      "id": "mobile_alignment",
      "label": "Mobile Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "mobile_font_family",
      "label": "Mobile Font Family",
      "options": [
        { "value": "Arial, sans-serif", "label": "Arial" },
        { "value": "Helvetica, sans-serif", "label": "Helvetica" },
        { "value": "Georgia, serif", "label": "Georgia" },
        { "value": "Times New Roman, serif", "label": "Times New Roman" },
        { "value": "Verdana, sans-serif", "label": "Verdana" },
        { "value": "Courier New, monospace", "label": "Courier New" }
      ],
      "default": "Arial, sans-serif"
    },
    {
      "type": "range",
      "id": "mobile_font_size",
      "label": "Mobile Font Size",
      "min": 8,
      "max": 24,
      "step": 1,
      "default": 12
    },
    {
      "type": "range",
      "id": "mobile_line_height",
      "label": "Mobile Line Height",
      "min": 1.0,
      "max": 2.0,
      "step": 0.1,
      "default": 1.2
    },
    {
      "type": "range",
      "id": "mobile_margin",
      "label": "Mobile Margin",
      "min": 0,
      "max": 30,
      "step": 1,
      "default": 6
    },
    {
      "type": "range",
      "id": "mobile_gap",
      "label": "Mobile Gap",
      "min": 0,
      "max": 16,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "mobile_width",
      "label": "Mobile Width (%)",
      "min": 20,
      "max": 100,
      "step": 5,
      "default": 100
    },
    {
      "type": "range",
      "id": "mobile_padding_vertical",
      "label": "Mobile Padding Vertical",
      "min": 3,
      "max": 24,
      "step": 1,
      "default": 6
    },
    {
      "type": "range",
      "id": "mobile_padding_horizontal",
      "label": "Mobile Padding Horizontal",
      "min": 6,
      "max": 32,
      "step": 1,
      "default": 12
    },
    {
      "type": "range",
      "id": "mobile_border_thickness",
      "label": "Mobile Border Thickness",
      "min": 0,
      "max": 6,
      "step": 1,
      "default": 1
    },
    {
      "type": "range",
      "id": "mobile_roundness",
      "label": "Mobile Roundness",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 4
    },
    {
      "type": "select",
      "id": "mobile_shadow_style",
      "label": "Mobile Shadow Style",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "0 1px 2px rgba(0,0,0,0.1)", "label": "Subtle" },
        { "value": "0 2px 6px rgba(0,0,0,0.15)", "label": "Medium" },
        { "value": "0 3px 10px rgba(0,0,0,0.2)", "label": "Strong" }
      ],
      "default": "0 1px 2px rgba(0,0,0,0.1)"
    },
    {
      "type": "select",
      "id": "mobile_content_alignment",
      "label": "Mobile Content Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    }
  ]
}
{% endschema %} 