{%- comment -%}
  ab-test-ab-redirect.liquid
  Injects JS for A/B bucketing and redirect using ?view=ab-b
  Usage: {% render 'ab-test-ab-redirect' %}
  
  This file has been optimized to minimize Liquid size by moving
  all JavaScript logic to an external file (ab-test-tracking.js)
{%- endcomment -%}

{%- comment -%} Pass product data to JavaScript before loading script {%- endcomment -%}
<script>
  window.abTestAppBaseUrl = "https://{{ shop.permanent_domain }}/apps/ab-optimizer-app";
  {% if product %}
  window.abTestProductData = {
    id: {{ product.id | json }},
    title: {{ product.title | json }},
    price: {{ product.price | json }}
  };
  {% endif %}
</script>

{%- comment -%} Load the external JavaScript file {%- endcomment -%}
<script src="{{ 'ab-test-tracking.js' | asset_url }}" defer></script>
